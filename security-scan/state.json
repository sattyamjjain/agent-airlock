{
  "scan_date": "2026-01-31",
  "last_updated": "2026-02-01",
  "project": "agent-airlock",
  "total_findings": 8,
  "fixed": 6,
  "findings": [
    {
      "id": 1,
      "severity": "critical",
      "title": "Unsafe Pickle Deserialization in Sandbox",
      "file": "src/agent_airlock/sandbox.py",
      "lines": "163-170",
      "status": "mitigated",
      "notes": "Runs inside E2B MicroVM isolation. Risk is contained - code executes in ephemeral sandbox with no host access. Defense-in-depth: could add HMAC signing but not required."
    },
    {
      "id": 2,
      "severity": "high",
      "title": "Unsafe exec() Fallback Without Warning",
      "files": ["examples/e2b_sandbox.py", "examples/fastmcp_integration.py"],
      "status": "fixed",
      "fixed_date": "2026-01-31",
      "fix_location": "src/agent_airlock/core.py:108,117,587-642",
      "notes": "sandbox_required=True parameter added. Raises SandboxUnavailableError instead of silent fallback."
    },
    {
      "id": 3,
      "severity": "medium",
      "title": "Path Traversal in Example File Operations",
      "files": ["examples/fastmcp_integration.py"],
      "status": "fixed",
      "fixed_date": "2026-01-31",
      "fix_location": "examples/fastmcp_integration.py:108-129",
      "notes": "Added validate_path() function with Path.resolve() + allowlist. ALLOWED_DIRECTORIES constant defined."
    },
    {
      "id": 4,
      "severity": "medium",
      "title": "Sensitive Parameter Names in Logs",
      "file": "src/agent_airlock/core.py",
      "lines": "50-82",
      "status": "fixed",
      "fixed_date": "2026-01-31",
      "fix_location": "src/agent_airlock/core.py:50-82",
      "notes": "SENSITIVE_PARAM_NAMES frozenset filters password, api_key, secret, token, etc from debug logs."
    },
    {
      "id": 5,
      "severity": "medium",
      "title": "Missing TOML Schema Validation",
      "file": "src/agent_airlock/config.py",
      "lines": "143-150",
      "status": "fixed",
      "fixed_date": "2026-01-31",
      "fix_location": "src/agent_airlock/config.py:143-150",
      "notes": "Added warning for unknown config keys with hint about typos."
    },
    {
      "id": 6,
      "severity": "low",
      "title": "In-Memory Rate Limit State",
      "file": "src/agent_airlock/policy.py",
      "status": "documented",
      "notes": "Known limitation. Documented in PRODUCTION_ROADMAP.md. Redis backend is P0 priority for v0.2.0."
    },
    {
      "id": 7,
      "severity": "low",
      "title": "Example Test Credentials",
      "file": "tests/test_config.py",
      "status": "fixed",
      "fixed_date": "2026-01-31",
      "fix_location": "tests/test_config.py:40",
      "notes": "Now uses FAKE-KEY-DO-NOT-USE-12345 pattern."
    },
    {
      "id": 8,
      "severity": "low",
      "title": "Missing Input Edge Case Tests",
      "file": "src/agent_airlock/policy.py",
      "status": "fixed",
      "fixed_date": "2026-02-01",
      "fix_location": "tests/test_policy.py",
      "notes": "Added 31 edge case tests for TimeWindow and RateLimit parsing."
    }
  ],
  "bandit_results": {
    "high": 0,
    "medium": 0,
    "low": 0
  }
}
